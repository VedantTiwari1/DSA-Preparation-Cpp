class Solution {
public:
    int concatenatedBinary(int n) {
        long long res = 0;
        int mod = 1e9 + 7;
        int length = 0; // The number of bits in the current number i

        for (int i = 1; i <= n; ++i) {
            // If i is a power of 2, the bit length increases
            // (e.g., 2 is 10, 4 is 100, 8 is 1000)
            if ((i & (i - 1)) == 0) {
                length++;
            }
            
            // Shift current result by 'length' and add 'i'
            res = ((res << length) | i) % mod;
        }
        
        return (int)res;
    }
};
