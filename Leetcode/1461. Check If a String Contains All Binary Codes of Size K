class Solution {
public:
    bool hasAllCodes(string s, int k) {
        // If the string isn't even long enough to hold the codes
        if (s.length() < k) return false;

        unordered_set<string> seen_codes;
        int total_needed = 1 << k; // This is equivalent to 2^k

        for (int i = 0; i <= (int)s.length() - k; ++i) {
            seen_codes.insert(s.substr(i, k));
            
            // Optimization: if we already found all codes, stop early
            if (seen_codes.size() == total_needed) return true;
        }

        return seen_codes.size() == total_needed;
    }
};
